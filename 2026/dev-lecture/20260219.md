# TIL — 2026-02-19

## 📌 Today Summary
- Spring AI를 활용해 ChatClient 기반 챗봇을 구현하고, 프롬프트 페르소나를 적용하는 구조를 이해했다.
- 핵심 키워드:
  - Spring AI 2.x
  - ChatClient Builder
  - System Persona Prompt
  - MVC + Thymeleaf 기반 Chat UI
  - Layered Architecture (Controller → Service → Infrastructure)

---

## 🎯 Today’s Focus
- 오늘의 학습 주제:
  - Spring AI를 이용한 LLM 연동
  - ChatClient 기반 프롬프트 호출 구조
  - 페르소나 기반 응답 제어

- 왜 이걸 공부했는가:
  - 단순 API 호출이 아닌, Spring Boot 환경에서 LLM을 구조적으로 통합하는 방법을 이해하기 위해
  - 서비스 레이어 기반으로 AI 기능을 확장 가능하게 설계하기 위해

- 기대했던 것:
  - ChatModel 직접 호출 방식과 ChatClient 방식의 차이 이해
  - 시스템 프롬프트를 통한 응답 스타일 제어

---

## 📘 What I Learned

### 핵심 개념

1. **Spring AI의 ChatClient 구조**
   - `ChatClient.Builder`를 주입받아 빌드
   - `prompt()` → `system()` → `user()` → `call()` → `content()` 체인 호출 구조
   - 선언형 DSL 형태로 가독성이 높음

2. **Layered Architecture 적용**
   - `ChatbotController` (Presentation)
   - `ChatbotService` (Application Interface)
   - `ChatbotServiceImpl` (Infrastructure)
   - AI 연동 로직을 Controller에 두지 않고 Service 계층에 분리

3. **System Persona Prompt**
   - "어린 왕자" 페르소나를 System Message로 주입
   - 응답 톤과 스타일을 통제
   - Temperature와 Model 옵션을 코드에서 직접 설정

---

### 중요한 포인트

- `ChatClient`는 내부적으로 모델 추상화를 제공하므로 구현체에 의존하지 않음
- `.options(ChatOptions.builder().model().temperature())` 방식으로 모델 세부 설정 가능
- System 메시지를 통해 응답 방향을 강하게 유도할 수 있음
- MVC 구조를 유지하면서 AI 기능을 자연스럽게 통합 가능
- REST 응답은 `TEXT_PLAIN`으로 단순화하여 프론트에서 쉽게 처리

---

### 인상 깊은 문장 / 내용

> 중요한 것은 눈에 보이지 않아 — 이 문장처럼, 프롬프트 설계가 실제 응답 품질을 결정한다.

---

## 🧠 Insight

- LLM 통합의 핵심은 API 호출이 아니라 **프롬프트 설계와 계층 분리**
- ChatModel 직접 호출 방식보다 ChatClient가 훨씬 선언적이고 유지보수성이 좋음
- 페르소나는 단순 문자열이 아니라 “응답 전략”이다
- 모델 선택과 temperature 조절이 UX에 직접적인 영향을 준다

이전에는 AI 연동을 단순 HTTP 호출로 생각했지만,  
이제는 “Spring 생태계 안에서 확장 가능한 컴포넌트”로 설계해야 한다는 관점으로 바뀌었다.

---

## 🛠 How I Can Use This

- 시스템에:
  - 질의응답 챗봇 추가
  - 자연어 → 전문 용어 정규화 기능
  - 업무 매뉴얼 기반 RAG 확장

- 바로 써먹을 수 있는 방법:
  1. 공통 AI 서비스 인터페이스 설계
  2. 페르소나 별 전략 클래스 분리
  3. ChatOptions를 환경설정(YAML) 기반으로 외부화
  4. Streaming 응답으로 UX 개선
  5. 추후 Vector Store 연결하여 RAG 구조 확장

---

오늘의 결론:  
Spring AI는 단순히 AI를 붙이는 기술이 아니라,  
“AI를 서비스 계층 안으로 끌어오는 설계 도구”다.
